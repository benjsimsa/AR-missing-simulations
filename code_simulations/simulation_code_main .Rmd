---
title: "Code for the simulations"
author: "benjamin simsa (benjamin.imsa@student.kuleuven.be)"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Import packages
```{r packages}
library(dplyr)
library(tidyr)
library(truncnorm)
library(nlme)
library(parameters)
library(lmerTest)
library(MASS)
library(here)
require(missMethods)
```

# Source the simulation functions 

```{r }
source(here::here("code_custom_functions", "simulation_functions_missing_mcar.R"))
```
# Data missing completely at random 


## AR = 0.3 

### Compliance = 0.4 

#### N = 20, T = 20 

```{r}
set.seed(4)

mcar_03_04_20_20 = Power.Sim.Estimates.mcar(N = 20,
                    T.obs = 20,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.4)


saveRDS(mcar_03_04_20_20, file = here::here("results", "mcar_03_04_20_20.rds"))
```

#### N = 20, T = 50

```{r}
set.seed(4)

mcar_03_04_20_50 = Power.Sim.Estimates.mcar(N = 20,
                    T.obs = 50,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.4)


saveRDS(mcar_03_04_20_50, file = here::here("results", "mcar_03_04_20_50.rds"))
```

#### N = 20, T = 100

```{r}
set.seed(4)

mcar_03_04_20_100 = Power.Sim.Estimates.mcar(N = 20,
                    T.obs = 100,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.4)


saveRDS(mcar_03_04_20_100, file = here::here("results", "mcar_03_04_20_100.rds"))
```

#### N = 100, T = 20 


```{r}
set.seed(4)

mcar_03_04_100_20 = Power.Sim.Estimates.mcar(N = 100,
                    T.obs = 20,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.4)


saveRDS(mcar_03_04_100_20, file = here::here("results", "mcar_03_04_100_20.rds"))
```


#### N = 100, T = 50

```{r}
set.seed(4)

mcar_03_04_100_50 = Power.Sim.Estimates.mcar(N = 100,
                    T.obs = 50,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.4)


saveRDS(mcar_03_04_100_50, file = here::here("results", "mcar_03_04_100_50.rds"))
```



#### N = 100, T = 100

```{r}
set.seed(4)

mcar_03_04_100_100 = Power.Sim.Estimates.mcar(N = 100,
                    T.obs = 100,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.4)


saveRDS(mcar_03_04_100_100, file = here::here("results", "mcar_03_04_100_100.rds"))
```

### Compliance = 0.6 

#### N = 20, T = 20 

```{r}
set.seed(4)

mcar_03_06_20_20 = Power.Sim.Estimates.mcar(N = 20,
                    T.obs = 20,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.6)


saveRDS(mcar_03_06_20_20, file = here::here("results", "mcar_03_06_20_20.rds"))
```

#### N = 20, T = 50

```{r}
set.seed(4)

mcar_03_06_20_50 = Power.Sim.Estimates.mcar(N = 20,
                    T.obs = 50,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.6)


saveRDS(mcar_03_06_20_50, file = here::here("results", "mcar_03_06_20_50.rds"))
```

#### N = 20, T = 100

```{r}
set.seed(4)

mcar_03_06_20_100 = Power.Sim.Estimates.mcar(N = 20,
                    T.obs = 100,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.6)


saveRDS(mcar_03_06_20_100, file = here::here("results", "mcar_03_06_20_100.rds"))
```

#### N = 100, T = 20 


```{r}
set.seed(4)

mcar_03_06_100_20 = Power.Sim.Estimates.mcar(N = 100,
                    T.obs = 20,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.6)


saveRDS(mcar_03_06_100_20, file = here::here("results", "mcar_03_06_100_20.rds"))
```


#### N = 100, T = 50

```{r}
set.seed(4)

mcar_03_06_100_50 = Power.Sim.Estimates.mcar(N = 100,
                    T.obs = 50,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.6)


saveRDS(mcar_03_06_100_50, file = here::here("results", "mcar_03_06_100_50.rds"))
```



#### N = 100, T = 100

```{r}
set.seed(4)

mcar_03_06_100_100 = Power.Sim.Estimates.mcar(N = 100,
                    T.obs = 100,
                    Ylag.center = TRUE,
                    b00 = 0,
                    b10 = 0.3,
                    sigma = sqrt(3), 
                    rho = 0, 
                    sigma.v0 = sqrt(3), 
                    sigma.v1 = 0, 
                    rho.v = 0, 
                    alpha = 0.05, 
                    R = 1000, 
                    compliance_mean = 0.6)


saveRDS(mcar_03_06_100_100, file = here::here("results", "mcar_03_06_100_100.rds"))
```

### Compliance = 0.8 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 1 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


## AR = 0.5

### Compliance = 0.4 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.6 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.8 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 1 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


## AR = 0.7

### Compliance = 0.4 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.6 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.8 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 1 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100




# Data missing in a block 


## AR = 0.3 

### Compliance = 0.4 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.6 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.8 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 1 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


## AR = 0.5

### Compliance = 0.4 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.6 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.8 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 1 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


## AR = 0.7

### Compliance = 0.4 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.6 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 0.8 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


### Compliance = 1 

#### N = 20, T = 20 

#### N = 20, T = 50

#### N = 20, T = 100

#### N = 100, T = 20 

#### N = 100, T = 50

#### N = 100, T = 100


